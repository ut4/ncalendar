/*
 almond 0.3.3 Copyright jQuery Foundation and other contributors.
 Released under MIT license, http://github.com/requirejs/almond/LICENSE
*/
var $jscomp={scope:{},makeIterator:function(l){if(l.$$iterator)return l.$$iterator();if(!(l instanceof Array)&&"string"!=typeof l)throw Error();var p=0;return{next:function(){return p==l.length?{done:!0}:{done:!1,value:l[p++]}}}},copyProperties:function(l,p){for(var g in p)l[g]=p[g]},inherits:function(l,p){function g(){}g.prototype=p.prototype;l.prototype=new g;l.prototype.constructor=l}};
(function(l,p){"function"===typeof define&&define.amd?define([],p):l.nullcalendar=p()})(this,function(){var l,p,g;(function(e){function b(m,d){var a,c,q,b,f,k,e,h,g,n=d&&d.split("/"),l=t.map,r=l&&l["*"]||{};if(m){m=m.split("/");f=m.length-1;t.nodeIdCompat&&y.test(m[f])&&(m[f]=m[f].replace(y,""));"."===m[0].charAt(0)&&n&&(f=n.slice(0,n.length-1),m=f.concat(m));for(f=0;f<m.length;f++)a=m[f],"."===a?(m.splice(f,1),--f):".."===a&&0!==f&&(1!==f||".."!==m[2])&&".."!==m[f-1]&&0<f&&(m.splice(f-1,2),f-=2);
m=m.join("/")}if((n||r)&&l){a=m.split("/");for(f=a.length;0<f;--f){c=a.slice(0,f).join("/");if(n)for(g=n.length;0<g;--g)if(q=l[n.slice(0,g).join("/")])if(q=q[c]){b=q;k=f;break}if(b)break;!e&&r&&r[c]&&(e=r[c],h=f)}!b&&e&&(b=e,k=h);b&&(a.splice(0,k,b),m=a.join("/"))}return m}function a(m,f){return function(){var d=B.call(arguments,0);"string"!==typeof d[0]&&1===d.length&&d.push(null);return h.apply(e,d.concat([m,f]))}}function c(m){return function(d){return b(d,m)}}function q(d){return function(f){r[d]=
f}}function d(d){if(u.call(w,d)){var f=w[d];delete w[d];z[d]=!0;n.apply(e,f)}if(!u.call(r,d)&&!u.call(z,d))throw Error("No "+d);return r[d]}function f(d){var f,a=d?d.indexOf("!"):-1;-1<a&&(f=d.substring(0,a),d=d.substring(a+1,d.length));return[f,d]}function k(d){return function(){return t&&t.config&&t.config[d]||{}}}var n,h,A,x,r={},w={},t={},z={},u=Object.prototype.hasOwnProperty,B=[].slice,y=/\.js$/;A=function(a,q){var k,e=f(a),h=e[0],n=q[1];a=e[1];h&&(h=b(h,n),k=d(h));h?a=k&&k.normalize?k.normalize(a,
c(n)):b(a,n):(a=b(a,n),e=f(a),h=e[0],a=e[1],h&&(k=d(h)));return{f:h?h+"!"+a:a,n:a,pr:h,p:k}};x={require:function(d){return a(d)},exports:function(d){var a=r[d];return"undefined"!==typeof a?a:r[d]={}},module:function(d){return{id:d,uri:"",exports:r[d],config:k(d)}}};n=function(c,b,k,h){var n,g,l,p,t,v=[];g=typeof k;var y;t=(h=h||c)?f(h):[];if("undefined"===g||"function"===g){b=!b.length&&k.length?["require","exports","module"]:b;for(p=0;p<b.length;p+=1)if(l=A(b[p],t),g=l.f,"require"===g)v[p]=x.require(c);
else if("exports"===g)v[p]=x.exports(c),y=!0;else if("module"===g)n=v[p]=x.module(c);else if(u.call(r,g)||u.call(w,g)||u.call(z,g))v[p]=d(g);else if(l.p)l.p.load(l.n,a(h,!0),q(g),{}),v[p]=r[g];else throw Error(c+" missing "+g);b=k?k.apply(r[c],v):void 0;c&&(n&&n.exports!==e&&n.exports!==r[c]?r[c]=n.exports:b===e&&y||(r[c]=b))}else c&&(r[c]=k)};l=p=h=function(a,c,b,k,q){if("string"===typeof a)return x[a]?x[a](c):d(A(a,c?f(c):[]).f);if(!a.splice){t=a;t.deps&&h(t.deps,t.callback);if(!c)return;c.splice?
(a=c,c=b,b=null):a=e}c=c||function(){};"function"===typeof b&&(b=k,k=q);k?n(e,a,c,b):setTimeout(function(){n(e,a,c,b)},4);return h};h.config=function(d){return h(d)};l._defined=r;g=function(d,a,c){if("string"!==typeof d)throw Error("See almond README: incorrect module build, no module name");a.splice||(c=a,a=[]);u.call(r,d)||u.call(w,d)||(w[d]=[d,a,c])};g.amd={jQuery:!0}})();g("vendor/almond",function(){});g("src/Constants",[],function(){return Object.freeze({VIEW_DAY:"day",VIEW_WEEK:"week",VIEW_MONTH:"month",
VIEW_DEFAULT:"week",HOURS_IN_DAY:24,DAYS_IN_WEEK:7})});g("src/Toolbar",["src/Constants"],function(e){var b={},a=(b[e.VIEW_DAY]=function(a){return"%1, %2".replace("%1",Intl.DateTimeFormat("fi",{day:"numeric",month:"long"}).format(a.start)).replace("%2",a.start.getFullYear())},b[e.VIEW_WEEK]=function(a){return"%1 %2 - %3 %4".replace("%1",Intl.DateTimeFormat("fi",{month:"short"}).format(a.start)).replace("%2",a.start.getDate()).replace("%3",a.end.getDate()).replace("%4",a.start.getFullYear())},b[e.VIEW_MONTH]=
function(a){return Intl.DateTimeFormat("fi",{month:"long",year:"numeric"}).format(a.start)},b),b=function(a){Inferno.Component.call(this,a)};$jscomp.copyProperties(b,Inferno.Component);$jscomp.inherits(b,Inferno.Component);b.prototype.render=function(){var c=this;return $el("div",{className:"toolbar"},$el("div",{className:"row"},$el("div",{className:"col"},$el("button",{onClick:this.props.dateCursor.prev.bind(this.props.dateCursor)},"<"),$el("button",{onClick:this.props.dateCursor.next.bind(this.props.dateCursor)},
">"),$el("button",{onClick:this.props.dateCursor.reset.bind(this.props.dateCursor)},"T\u00e4n\u00e4\u00e4n")),$el("div",{className:"col"},$el("h2",null,(this.props.titleFormatter||a[this.props.currentView])(this.props.dateCursor.range))),$el("div",{className:"col"},$el("button",{onClick:function(){c.props.onViewChange(e.VIEW_MONTH)}},"Kuukausi"),$el("button",{onClick:function(){c.props.onViewChange(e.VIEW_WEEK)}},"Viikko"),$el("button",{onClick:function(){c.props.onViewChange(e.VIEW_DAY)}},"P\u00e4iv\u00e4"))))};
return{default:b,titleFormatters:a}});g("src/ContentLayerFactory",[],function(){var e=function(){this.registrar={}};e.prototype.register=function(b,a){if(this.isRegistered(b))throw Error('Layer "'+b+'" on jo rekister\u00f6ity.');this.registrar[b]=a};e.prototype.isRegistered=function(b){return this.registrar.hasOwnProperty(b)};e.prototype.make=function(b,a){if(!this.isRegistered(b))throw Error('Layeria "'+b+'" ei ole rekister\u00f6ity.');return new Function.prototype.bind.apply(this.registrar[b],[].concat(a))};
return{default:e}});g("src/DateUtils",[],function(){var e=Array.from(Array(7)),b=function(){};b.prototype.getEstimatedFirstDayOfWeek=function(){return(new Date(2017,5,5,12,0,0,0)).getDay()};b.prototype.getStartOfWeek=function(a){var c=this.getEstimatedFirstDayOfWeek(),b=new Date(a);b.setDate(a.getDate()-(7+a.getDay()-c)%7);return b};b.prototype.getFormattedWeekDays=function(a,c){var b=this.getStartOfWeek(a);return e.map(function(){var a=c.format(b);b.setDate(b.getDate()+1);return a})};b.prototype.getStartOfDay=
function(a){a=new Date(a);a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(1);return a};b.prototype.getEndOfDay=function(a){a=new Date(a);a.setHours(23);a.setMinutes(59);a.setSeconds(59);a.setMilliseconds(999);return a};b.prototype.formatHour=function(a){return(10>a?"0":"")+a+":00"};b.prototype.format=function(a,b){return Intl.DateTimeFormat("fi",a).format(b)};return{default:b}});g("src/ioc",["src/ContentLayerFactory","src/DateUtils"],function(e,b){var a={},c=function(b,d){a.hasOwnProperty(b)||
(a[b]=d());return a[b]};return{default:{dateUtils:function(){return c("dateUtils",function(){return new b.default})},contentLayerFactory:function(){return c("contentLayerFactory",function(){return new e.default})}}}});g("src/Header",["src/Constants","src/ioc"],function(e,b){var a=b.default.dateUtils(),c=function(a){Inferno.Component.call(this,a)};$jscomp.copyProperties(c,Inferno.Component);$jscomp.inherits(c,Inferno.Component);c.prototype.render=function(){return $el("div",{className:"header"},$el("div",
{className:"row"},$el("div",{className:"col"},$el("div",{className:"cell"},"")),$el("div",{className:"col"},$el("div",{className:"cell"},this.formatDay(this.props.dateCursor.range.start)))))};c.prototype.formatDay=function(a){return Intl.DateTimeFormat("fi",{weekday:"long"}).format(a)};var q=function(d){Inferno.Component.call(this,d);this.DAYS=a.getFormattedWeekDays(this.props.dateCursor.range.start,Intl.DateTimeFormat("fi",{weekday:"short"}))};$jscomp.copyProperties(q,Inferno.Component);$jscomp.inherits(q,
Inferno.Component);q.prototype.render=function(){return $el("div",{className:"header"},$el("div",{className:"row"},[""].concat(this.DAYS).map(function(a){return $el("div",{className:"col"},$el("div",{className:"cell"},a))})))};var d=function(d){Inferno.Component.call(this,d);this.DAYS=a.getFormattedWeekDays(this.props.dateCursor.range.start,Intl.DateTimeFormat("fi",{weekday:"long"}))};$jscomp.copyProperties(d,Inferno.Component);$jscomp.inherits(d,Inferno.Component);d.prototype.render=function(){return $el("div",
{className:"header"},$el("div",{className:"row"},this.DAYS.map(function(a){return $el("div",{className:"col"},$el("div",{className:"cell"},a))})))};var f={};return f[e.VIEW_DAY]=c,f[e.VIEW_WEEK]=q,f[e.VIEW_MONTH]=d,f});g("src/Content",["src/Constants","src/ioc"],function(e,b){var a=Array.from(Array(e.HOURS_IN_DAY).keys()),c=function(a){Inferno.Component.call(this,a);this.state={};this.contentLayerFactory=b.default.contentLayerFactory();if(this.hasAsyncContent=0<this.props.selectedContentLayers.length){var f=
this;this.contentLayers=this.props.selectedContentLayers.map(function(a){return f.contentLayerFactory.make(a,[f.props.dateCursor,f.props.currentView,f.props.isCompactViewEnabled])});this.loadAsyncContent()}};$jscomp.copyProperties(c,Inferno.Component);$jscomp.inherits(c,Inferno.Component);c.prototype.componentWillReceiveProps=function(a){this.hasAsyncContent&&(this.setState({loading:!0}),this.loadAsyncContent(a))};c.prototype.loadAsyncContent=function(a){var b=this;a&&this.contentLayers.map(function(b){b.dateCursor=
a.dateCursor;b.currentView=a.currentView;b.isCompactViewEnabled=a.isCompactViewEnabled});return Promise.all(this.contentLayers.map(function(a){return a.load()})).then(function(){b.applyAsyncContent();b.setState({loading:!1})})};c.prototype.applyAsyncContent=function(){var a=this;this.contentLayers.forEach(function(b){a.props.grid.forEach(function(a){a.forEach(function(a){a instanceof q&&b.decorateCell(a)})})})};c.prototype.newCell=function(a){var b=void 0,b=a?a.children&&a.children.length?this.newTitledContent(a):
a.content:"";return $el("div",{className:"col"},$el("div",{className:"cell"},b))};c.prototype.newTitledContent=function(a){return $el("span",null,a.content,a.children.map(function(a){return Array.isArray(a)?a.map(function(a){return $el(a.Component,a.props)}):$el(a.Component,a.props)}))};c.prototype.render=function(){var a=this;return $el("div",{className:"main"},this.props.grid.map(function(b){return $el("div",{className:"row"},b.map(function(b){return a.newCell(b)}))}))};var q=function(a,b){this.date=
b;this.content=a;this.children=[]};return{default:c,Cell:q,ImmutableCell:function(a){this.content=a},HOURS_ARRAY:a}});g("src/ComponentConstruct",[],function(){return{default:function(e,b){this.Component=e;this.props=b}}});g("src/AbstractViewLayout",["src/Header","src/Content","src/ComponentConstruct","src/ioc"],function(e,b,a,c){var q=function(a){this.dateCursor=a;this.dateUtils=c.default.dateUtils()};q.prototype.getParts=function(a){return a?this.getCompactLayout():this.getFullLayout()};q.prototype.getFullLayout=
function(){var d=this;return[new a.default(e[this.getName()],{dateCursor:this.dateCursor}),new a.default(b.default,{gridGeneratorFn:function(){return d.generateFullGrid()}})]};q.prototype.getCompactLayout=function(){var d=this;return[null,new a.default(b.default,{gridGeneratorFn:function(){return d.generateCompactGrid()}})]};return{default:q}});g("src/DayViewLayout",["src/AbstractViewLayout","src/Content","src/Constants"],function(e,b,a){var c=function(a){e.default.apply(this,arguments)};$jscomp.copyProperties(c,
e.default);$jscomp.inherits(c,e.default);c.prototype.getName=function(){return a.VIEW_DAY};c.prototype.getCompactLayout=function(){return this.getFullLayout()};c.prototype.generateFullGrid=function(){var a=this,d=new Date(this.dateCursor.range.start);return b.HOURS_ARRAY.map(function(c){d.setHours(c);return[new b.ImmutableCell(a.dateUtils.formatHour(c)),new b.Cell(null,new Date(d))]})};return{default:c}});g("src/WeekViewLayout",["src/AbstractViewLayout","src/Content","src/Constants"],function(e,b,
a){var c=function(a){e.default.apply(this,arguments)};$jscomp.copyProperties(c,e.default);$jscomp.inherits(c,e.default);c.prototype.getName=function(){return a.VIEW_WEEK};c.prototype.generateFullGrid=function(){var c=this;return b.HOURS_ARRAY.map(function(d){var f=new Date(c.dateCursor.range.start);f.setHours(d);for(d=[new b.ImmutableCell(c.dateUtils.formatHour(d))];d.push(new b.Cell(null,new Date(f)))<=a.DAYS_IN_WEEK;)f.setDate(f.getDate()+1);return d})};c.prototype.generateCompactGrid=function(){var a=
this.dateUtils.getFormattedWeekDays(this.dateCursor.range.start,Intl.DateTimeFormat("fi",{weekday:"long"})),d=new Date(this.dateCursor.range.start),c=function(){var a=new Date(d);d.setDate(d.getDate()+1);return a};return[[new b.Cell(a[0],c()),new b.Cell(a[1],c())],[new b.Cell(a[2],c()),new b.Cell(a[3],c())],[new b.Cell(a[4],c()),new b.Cell(a[5],c())],[new b.Cell(a[6],c()),new b.ImmutableCell("T\u00e4ll\u00e4 viikolla: ? tapahtumaa")]]};return{default:c}});g("src/MonthViewLayout",["src/AbstractViewLayout",
"src/Content","src/Constants"],function(e,b,a){var c=function(a){e.default.apply(this,arguments)};$jscomp.copyProperties(c,e.default);$jscomp.inherits(c,e.default);c.prototype.getName=function(){return a.VIEW_MONTH};c.prototype.generateFullGrid=function(){return this.generateGrid(a.DAYS_IN_WEEK,function(a){return new b.Cell(a.getDate(),new Date(a))})};c.prototype.generateCompactGrid=function(){var a=this.dateUtils.getFormattedWeekDays(this.dateCursor.range.start,Intl.DateTimeFormat("fi",{weekday:"short"}));
return this.generateGrid(2,function(c){return new b.Cell(c.getDate()+" "+a[(c.getDay()||7)-1],new Date(c))})};c.prototype.generateGrid=function(b,c){var e=this.dateCursor.range.start,k=new Date(e),g=[],h=[];b===a.DAYS_IN_WEEK&&(h.length=(e.getDay()||7)-1,h.fill(void 0));for(;k.getMonth()===e.getMonth();)h.push(c(k)),h.length===b&&(g.push(h),h=[]),k.setDate(k.getDate()+1);if(h.length){for(;h.push(void 0)<b;);g.push(h)}return g};return{default:c}});g("src/ViewLayouts",["src/DayViewLayout","src/WeekViewLayout",
"src/MonthViewLayout","src/Constants"],function(e,b,a,c){var g={};return g[c.VIEW_DAY]=e.default,g[c.VIEW_WEEK]=b.default,g[c.VIEW_MONTH]=a.default,g});g("src/DateCursors",["src/Constants","src/ioc"],function(e,b){var a=b.default.dateUtils(),c=function(b){this.start=a.getStartOfDay(b);this.end=a.getEndOfDay(b)};c.prototype.goForward=function(){this.start.setDate(this.start.getDate()+1);this.end.setDate(this.end.getDate()+1)};c.prototype.goBackwards=function(){this.start.setDate(this.start.getDate()-
1);this.end.setDate(this.end.getDate()-1)};var g=function(b){this.start=a.getStartOfWeek(a.getStartOfDay(b));this.end=a.getEndOfDay(this.start);this.end.setDate(this.start.getDate()+6)};g.prototype.goForward=function(){this.start.setDate(this.start.getDate()+e.DAYS_IN_WEEK);this.end.setDate(this.end.getDate()+e.DAYS_IN_WEEK)};g.prototype.goBackwards=function(){this.start.setDate(this.start.getDate()-e.DAYS_IN_WEEK);this.end.setDate(this.end.getDate()-e.DAYS_IN_WEEK)};var d=function(b){this.start=
a.getStartOfDay(b);this.start.setDate(1);this.end=a.getEndOfDay(b);this.end.setMonth(this.start.getMonth()+1);this.end.setDate(0)};d.prototype.goForward=function(){this.start.setMonth(this.start.getMonth()+1);this.start.setDate(1);this.end.setMonth(this.end.getMonth()+2);this.end.setDate(0)};d.prototype.goBackwards=function(){this.start.setMonth(this.start.getMonth()-1);this.start.setDate(1);this.end.setDate(0)};var f=function(a,b){this.range=a;b&&this.subscribe(b)};f.prototype.subscribe=function(a){this.notify=
a};f.prototype.next=function(){this.range.goForward();this.notify("next")};f.prototype.prev=function(){this.range.goBackwards();this.notify("prev")};f.prototype.reset=function(){this.range=new this.range.constructor(new Date);this.notify("reset")};f.prototype.goTo=function(){this.notify("goTo")};var k={},n=(k[e.VIEW_DAY]=c,k[e.VIEW_WEEK]=g,k[e.VIEW_MONTH]=d,k);return{dateCursorFactory:{newCursor:function(a,b){return new f(new n[a](new Date),b)}}}});g("src/settingsFactory",["src/Constants"],function(e){function b(a){var b=
e["VIEW_"+a.toUpperCase()];if(!b)throw Error('N\u00e4kym\u00e4\u00e4 "'+a+'" ei l\u00f6ytynyt');return b}return{default:function(a){var c=b(a.defaultView||"default"),g;if(g=a.contentLayers){if(!Array.isArray(g))throw Error("contentLayers pit\u00e4isi olla taulukko");}else g=[];var d;if(a=a.titleFormatters){for(d in a){if("function"!==typeof a[d])throw Error("titleFormatters["+d+"] pit\u00e4isi olla funktio");if(d!==e.VIEW_DAY&&d!==e.VIEW_WEEK&&d!==e.VIEW_MONTH)throw Error('"'+d+'" ei ole validi n\u00e4kym\u00e4');
}d=a}else d={};return{defaultView:c,contentLayers:g,titleFormatters:d}},getValidViewName:b}});g("src/CalendarLayout",["src/Toolbar","src/Constants","src/ViewLayouts","src/DateCursors","src/settingsFactory"],function(e,b,a,c,g){var d=window.matchMedia("(max-width:800px)"),f=function(a){Inferno.Component.call(this,a);this.settings=g.default(a.settings||{});a={dateCursor:this.newDateCursor(this.settings.defaultView)};a.currentView=this.settings.defaultView;a.viewLayout=this.newViewLayout(a.currentView,
a.dateCursor);a.smallScreenConditionMaches=d.matches;this.state=a};$jscomp.copyProperties(f,Inferno.Component);$jscomp.inherits(f,Inferno.Component);f.prototype.componentWillMount=function(){d.addListener(this.viewPortListener.bind(this))};f.prototype.changeView=function(a){a=g.getValidViewName(a);if(this.state.currentView!==a){var b={dateCursor:this.newDateCursor(a),currentView:a};b.viewLayout=this.newViewLayout(a,b.dateCursor);this.setState(b)}};f.prototype.viewPortListener=function(a){a=a.matches;
a!==this.state.smallScreenConditionMaches&&this.setState({smallScreenConditionMaches:a})};f.prototype.newDateCursor=function(a){var b=this;return c.dateCursorFactory.newCursor(a,function(){b.setState({dateCursor:b.state.dateCursor})})};f.prototype.newViewLayout=function(b,c){return new a[b](c)};f.prototype.render=function(){var a=this,c="cal "+this.state.currentView;this.state.smallScreenConditionMaches&&this.state.currentView!==b.VIEW_DAY&&(c+="-compact compact");var d=this.state.viewLayout.getParts(this.state.smallScreenConditionMaches),
f=d[0],d=d[1];return $el("div",{className:c},$el(e.default,{dateCursor:this.state.dateCursor,currentView:this.state.currentView,onViewChange:function(b){return a.changeView(b)},titleFormatter:this.settings.titleFormatters[this.state.currentView]||null}),null!==f&&$el(f.Component,f.props),$el(d.Component,{grid:d.props.gridGeneratorFn(),selectedContentLayers:this.settings.contentLayers,dateCursor:this.state.dateCursor,currentView:this.state.currentView,isCompactViewEnabled:this.state.smallScreenConditionMaches}))};
return{default:f}});g("nullcalendar",["src/CalendarLayout","src/ioc"],function(e,b){function a(a){this.currentView=a.currentView;this.dateCursor=a.dateCursor;this.settings=a.settings;this.changeView=function(b){return a.changeView(b)}}var c=b.default.contentLayerFactory();return{newCalendar:function(b,c){return new a(Inferno.render($el(e.default,c),b))},registerContentLayer:function(a,b){return c.register(a,b)}}});return p("nullcalendar")});
